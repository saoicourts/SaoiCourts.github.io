<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Bundle Networks</title>

		<link rel="stylesheet" href="../dist/reset.css">
		<link rel="stylesheet" href="../dist/reveal.css">
		<link rel="stylesheet" href="../dist/theme/beige.css" id="theme">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="../plugin/highlight/monokai.css" id="highlight-theme">

		<style>
			.blue-highlight { color: #1b91ff}
			.red-highlight {color: crimson}
			.green-highlight {color:rgb(127, 167, 60)}
			.orange-highlight {color:darkorange}
		</style>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section data-markdown>
					<textarea data-template>
						## Bundle Networks
						#### Fiber Bundles, Local Trivializations, and a Generative Approach to Exploring Many-to-one Maps
						<br>

						<div style="display:flex; width:100%; justify-content: space-around;"> 
						<div>
							<span class="orange-highlight">Nico Courts</span>
							<p style="font-size: 18pt;">University of Washington<br />
							Pacific Northwest National Laboratory</p>
							<p style="font-size: 18pt;">nico@nicocourts.com</p>
						</div>
						<div>
							<span class="blue-highlight">Henry Kvinge</span>
							<p style="font-size: 18pt;">Pacific Northwest National Laboratory<br />
							University of Washington</p>
							<p style="font-size: 18pt;">henry.kvinge@pnnl.gov</p>
						</div>
					</textarea>
				</section>
				<section data-markdown>
					<textarea data-template>
						Code and data for our work can be found at
						https://github.com/NicoCourts/bundle-networks/
						<br /><br />

						Slides for this presentation can be found at
						https://nicocourts.com/talks/iclr-2022-bundlenets/
					</textarea>
				</section>
				</section>
				<section data-markdown>
					<textarea data-template>
						### Motivation: Materials science
						In some material fabrication processes there are many human-designed parameters that can be changed to affect the end product, but often researchers are only interested 
						in one (or very few) output parameters.

						![many-to-one process](images/many-to-one.png)<!--.element: style="width:40%"-->
					</textarea>
				</section>
				<section data-markdown>
					<textarea data-template>
						### A question
						An early observation we made is that the manufacturing process naturally formed a <span class="red-highlight">many-to-one map.</span>

						One question one may ask is <span class="green-highlight">"In what ways can I change my configuration that keeps the end product constant?"</span>
					</textarea>
				</section>

				<section data-markdown>
					<textarea data-template>
						### A mathematical construction: Fiber bundles
						![bundles](images/bundle.png)<!--.element: style="width:60%"-->

						A <span class="blue-highlight">fiber bundle</span> is a base space $X$, a total space $E$, and a surjection $\pi:E\to X$ satisfying <span class="red-highlight">local triviality.</span>
						In essence, this means that $E$ is a space parameterized by $X$ that is <span class="green-highlight">basically the same everywhere.</span>
					</textarea>
				</section>
				<section data-markdown>
					<textarea data-template>
						### Distilling the problem
						Under the assumption that the true data lies on a fiber bundle, we can rephrase the problem in the following way:

						Create a model that performs density estimation on the <span class="orange-highlight">fiber over a point</span>, that is, $\pi^{-1}(y)$ for any $y$ in the base space. 
						
						In doing so, construct a <span class="red-highlight">fiberwise-accurate reconstruction</span> of the true bundle underlying the data.
					</textarea>
				</section>



				
				<section data-markdown>
					<textarea data-template>
						### Using neighborhoods
						**Input:** Data in the total space $\mathcal{D}_\text{bundle}\subseteq X$ and base space $\mathcal{D}_\text{base}\subseteq Y$.
						
						Compute <span class="blue-highlight">neighborhoods $\\{U_i\\}_{i\in\mathcal I}$</span> in $\mathcal{D}_\text{base}$, 
						each with a <span class="red-highlight">representative point $r_i\in U_i$</span>.
						
						To run the model, <span class="red-highlight">condition on nearest $r\in \mathcal{R}=\\{r_i\\}_{i\in\mathcal I}$</span>.
					</textarea>
				</section>
				<section data-markdown>
					<textarea data-template>
						### Model architecture
						![model](images/model.png)
					</textarea>
				</section>




				<section data-markdown>
					<textarea data-template>
						### Models tested
						- Our model, <span class="blue-highlight">BundleNet</span>
						- <span class="green-highlight">WGAN</span>&mdash;Wasserstein GAN 
						- <span class="red-highlight">CGAN</span>&mdash;Conditional GAN 
							- Conditioned on individual base points 
							- Batches drawn from global distribution
						- <span class="orange-highlight">CGAN-local</span>&mdash;A CGAN that
							- is conditioned on finitely many neighborhood representatives
							- is trained with batches drawn from a single neighborhood at a time
					</textarea>
				</section>

				<section data-markdown>
					<textarea data-template>
						### Results
						![bundlenet results](images/bn-results.png)
					</textarea>
				</section>
				<section data-markdown>
					<textarea data-template>
						### Reconstructions
						<div style="display:flex; justify-content: space-around; width:100%"><div id='bn-torus' style="width:50%; overflow:hidden"></div><div id='cgan-torus' style="width:50%; overflow:hidden"></div></div>
					</textarea>
				</section>
				<section data-markdown>
					<textarea data-template>
						### Reconstructions
						<div style="display:flex; justify-content: space-around; width:100%;"><div id='bn-moeb' style="width:50%; overflow:hidden"></div><div id='cgan-moeb' style="width:50%; overflow:hidden"></div></div>
					</textarea>
				</section>
				<section data-markdown>
					<textarea data-template>
						### Further questions studied
						- What is the effect of different topological choices on prior distributions?
						- How well can Bundle Networks approximate distributions with non-uniform neighborhoods?
						- What are possible further directions for study?
					</textarea>
				</section>



				<section>
					<h2>Thank you!</h2>
				</section>
			</div>
		</div>

		<script src="../dist/reveal.js"></script>
		<script src="../plugin/math/math.js"></script>
		<script src="../plugin/markdown/markdown.js"></script>
		<script src="../plugin/highlight/highlight.js"></script>
		<script src="../plugin/zoom/zoom.js"></script>
		<script src="https://d3js.org/d3.v7.min.js"></script>
		<script src="https://cdn.plot.ly/plotly-2.6.3.min.js"></script>


		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
				
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealMath, RevealZoom ]
			});

			// helper function for plotly
			function unpack(rows, key) {
				return rows.map(function(row) { return row[key]; });
			}

			var use_width = screen.width/5

			// Load data and populate graph
			fetch('data/BN_torus.json')
				.then(response => response.json())
				.then(function(data){
					var unpacked = [{
						x: unpack(data, 'bundle_x'),
						y: unpack(data, 'bundle_y'),
						z: unpack(data, 'bundle_z'),
						mode: 'markers',
						type: 'scatter3d',
						
						marker: {
						color: unpack(data, 'angle'),
						size: 2,
						colorscale: 'Jet',
						}
					}];

					layout = {
						title: "BundleNet Torus Reconstruction",
						width: use_width,
						scene:{
							
							aspectmode: "manual",
							aspectratio: {
							x: 1, y: 1, z: 1,
							},
							xaxis: {
							nticks: 9,
							range: [-10, 10],
							},
							yaxis: {
							nticks: 7,
							range: [-10, 10],
							},
							zaxis: {
							nticks: 10,
							range: [-10, 10],
							}
						}
					};

					// plot!
					Plotly.newPlot('bn-torus', unpacked, layout);
				})
				// CGAN torus
				fetch('data/CGAN_triv_torus.json')
				.then(response => response.json())
				.then(function(data){
					var unpacked = [{
						x: unpack(data, 'bundle_x'),
						y: unpack(data, 'bundle_y'),
						z: unpack(data, 'bundle_z'),
						mode: 'markers',
						type: 'scatter3d',
						
						marker: {
						color: unpack(data, 'angle'),
						size: 2,
						colorscale: 'Jet',
						}
					}];

					layout = {
						title: "CGAN-local Torus Reconstruction",
						width: use_width,
						scene:{
							
							aspectmode: "manual",
							aspectratio: {
							x: 1, y: 1, z: 1,
							},
							xaxis: {
							nticks: 9,
							range: [-10, 10],
							},
							yaxis: {
							nticks: 7,
							range: [-10, 10],
							},
							zaxis: {
							nticks: 10,
							range: [-10, 10],
							}
						}
					};

					// plot!
					Plotly.newPlot('cgan-torus', unpacked, layout);
				})
			// moeb
			fetch('data/BN_moebius.json')
				.then(response => response.json())
				.then(function(data){
					var unpacked = [{
						x: unpack(data, 'bundle_x'),
						y: unpack(data, 'bundle_y'),
						z: unpack(data, 'bundle_z'),
						mode: 'markers',
						type: 'scatter3d',
						
						marker: {
						color: unpack(data, 'angle'),
						size: 2,
						colorscale: 'Jet',
						}
					}];

					layout = {
						title: "BundleNet Moebius Band Reconstruction",
						width: use_width,
						scene:{
							
							aspectmode: "manual",
							aspectratio: {
							x: 1, y: 1, z: 1,
							},
							xaxis: {
							nticks: 9,
							range: [-10, 10],
							},
							yaxis: {
							nticks: 7,
							range: [-10, 10],
							},
							zaxis: {
							nticks: 10,
							range: [-10, 10],
							}
						}
					};

					// plot!
					Plotly.newPlot('bn-moeb', unpacked, layout);
				})
				// CGAN moeb
				fetch('data/CGAN_triv_moebius.json')
				.then(response => response.json())
				.then(function(data){
					var unpacked = [{
						x: unpack(data, 'bundle_x'),
						y: unpack(data, 'bundle_y'),
						z: unpack(data, 'bundle_z'),
						mode: 'markers',
						type: 'scatter3d',
						
						marker: {
						color: unpack(data, 'angle'),
						size: 2,
						colorscale: 'Jet',
						}
					}];

					layout = {
						title: "CGAN-local Moebius Band Reconstruction",
						width: use_width,
						scene:{
							aspectmode: "manual",
							aspectratio: {
							x: 1, y: 1, z: 1,
							},
							xaxis: {
							nticks: 9,
							range: [-10, 10],
							},
							yaxis: {
							nticks: 7,
							range: [-10, 10],
							},
							zaxis: {
							nticks: 10,
							range: [-10, 10],
							}
						}
					};

					// plot!
					Plotly.newPlot('cgan-moeb', unpacked, layout);
				})
		</script>
	</body>
</html>
